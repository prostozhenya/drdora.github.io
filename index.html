<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>–° –î–Ω—ë–º –†–æ–∂–¥–µ–Ω–∏—è, –î–∞—à–∞ üíñ</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap');

body {
  margin: 0;
  height: 100vh;
  font-family: 'Poppins', sans-serif;
  display: flex;
  justify-content: center;
  align-items: center;
  flex-direction: column;
  background: linear-gradient(135deg,#1a0f2c,#2c1f4d);
  position: relative;
  color: white;
  overflow: hidden;
}

/* –ó–∞–≥–æ–ª–æ–≤–æ–∫ */
h1 {
  position: absolute;
  top: 10%;
  font-size: 3em;
  text-align: center;
  color: #cda4ff;
  text-shadow: 0 0 10px #b080ff, 0 0 30px #a060ff;
  opacity: 0;
  animation: fadeIn 3s forwards;
}

@keyframes fadeIn { to { opacity: 1; } }

/* === –§–õ–ê–ì === */
.flag {
  position: absolute;
  top: 22%;
  right: 10%;
  width: 220px;
  opacity: 1;
  filter: drop-shadow(0 0 15px rgba(120,90,220,0.7))
          drop-shadow(0 0 30px rgba(180,155,250,0.4));
  transform-origin: left center;
  animation: flagAppear 1.5s ease forwards 1s, flagWave 5s ease-in-out infinite 2.5s;
  transition: opacity 1s ease, transform 1s ease;
}

@keyframes flagAppear {
  from { transform: translateY(-30px) scale(0.9); opacity: 0; }
  to { transform: translateY(0) scale(1); opacity: 1; }
}

/* "—Ä–∞–∑–≤–µ–≤–∞–Ω–∏–µ" —Ñ–ª–∞–≥–∞ */
@keyframes flagWave {
  0% { transform: rotateZ(-2deg) skewY(0deg); }
  25% { transform: rotateZ(2deg) skewY(2deg); }
  50% { transform: rotateZ(-1deg) skewY(-2deg); }
  75% { transform: rotateZ(1deg) skewY(1deg); }
  100% { transform: rotateZ(-2deg) skewY(0deg); }
}

.flag.hide {
  opacity: 0;
  transform: translateY(-80px) rotate(-10deg) scale(0.8);
  pointer-events: none;
}

/* === –ü–ï–ß–ï–ù–¨–ö–ê === */
.cookie {
  position: absolute;
  bottom: 18%;
  left: 10%;
  width: 120px;
  opacity: 0;
  transform: scale(0.8);
  filter: drop-shadow(0 0 15px rgba(180,155,250,0.6))
          drop-shadow(0 0 30px rgba(120,90,220,0.3));
  animation: cookieAppear 2s ease forwards 2.5s, cookieFloat 6s ease-in-out infinite 4.5s;
}

@keyframes cookieAppear {
  from { transform: translateY(30px) scale(0.8); opacity: 0; }
  to { transform: translateY(0) scale(1); opacity: 1; }
}

@keyframes cookieFloat {
  0%, 100% { transform: translateY(0) rotate(0deg) scale(1); }
  25% { transform: translateY(-10px) rotate(-6deg) scale(1.05); }
  50% { transform: translateY(0) rotate(4deg) scale(1); }
  75% { transform: translateY(8px) rotate(-4deg) scale(1.03); }
}

/* –ö–Ω–æ–ø–∫–∞ –∑–∞–ø—É—Å–∫–∞ –º—É–∑—ã–∫–∏ */
#playButton {
  padding: 15px 40px;
  font-size: 1.3em;
  border: none;
  border-radius: 25px;
  background: rgba(255, 255, 255, 0.05);
  backdrop-filter: blur(15px) saturate(180%);
  color: #fff;
  cursor: pointer;
  box-shadow: 0 0 20px rgba(120,90,220,0.6);
  transition: 0.3s;
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
}

#playButton:hover {
  transform: translateY(-50%) scale(1.1);
  box-shadow: 0 0 40px rgba(180,155,250,0.9);
}

/* Canvas —ç–∫–≤–∞–ª–∞–π–∑–µ—Ä–∞ */
#equalizer {
  position: absolute;
  bottom: 60px;
  width: 90%;
  max-width: 900px;
  height: 120px;
  border-radius: 25px;
  backdrop-filter: blur(25px) saturate(180%);
  -webkit-backdrop-filter: blur(25px) saturate(180%);
  background: rgba(30, 20, 50, 0.15);
  box-shadow:
    0 0 30px rgba(180,155,250,0.6),
    inset 0 0 25px rgba(120,90,220,0.3);
  overflow: hidden;
}

#equalizerCanvas {
  width: 100%;
  height: 100%;
}

/* –§–æ—Ç–æ */
.photo {
  position: absolute;
  width: 120px;
  height: 120px;
  border-radius: 20px;
  object-fit: cover;
  pointer-events: none;
  transform: translate(-50%, -50%);
  box-shadow: 0 0 20px rgba(180,155,250,0.8),
              0 0 40px rgba(120,90,220,0.5);
  transition: transform 0.3s ease, opacity 0.3s ease;
}

/* –°–Ω–µ–≥ */
.snowflake {
  position: fixed;
  top: -10px;
  color: white;
  font-size: 1em;
  user-select: none;
  pointer-events: none;
  animation: fall linear infinite;
  opacity: 0.6;
}

@keyframes fall {
  to { transform: translateY(110vh) rotate(360deg); }
}

/* Footer */
footer {
  position: absolute;
  bottom: 20px;
  text-align: center;
  font-size: 14px;
  color: #b080ff;
}
footer a {
  color: #cda4ff;
  text-decoration: none;
  margin: 0 6px;
}
</style>
</head>
<body>

<h1>–° –î–Ω—ë–º –†–æ–∂–¥–µ–Ω–∏—è, –î–∞—à–∞ üéÇüí´</h1>

<!-- –§–ª–∞–≥ -->
<img src="images/flag.png" alt="—Ñ–ª–∞–≥" class="flag" id="flag">

<!-- –ü–µ—á–µ–Ω—å–∫–∞ -->
<img src="images/cookie.png" alt="–ø–µ—á–µ–Ω—å–∫–∞" class="cookie" id="cookie">

<button id="playButton">–ù–∞–∂–º–∏ üéµ</button>

<audio id="bgm" loop>
  <source src="music/papa_temnogo_princa.mp3" type="audio/mpeg" />
</audio>

<div id="equalizer">
  <canvas id="equalizerCanvas"></canvas>
</div>

<footer>
  designed by <b>prostozhenyaaa</b><br />
  <a href="#">Instagram</a> | <a href="#">VK</a> | <a href="#">Telegram</a>
</footer>

<script>
const photos = [
  "images/dasha1.jpg",
  "images/dasha2.jpg",
  "images/dasha3.jpg",
  "images/dasha4.jpg",
  "images/dasha5.jpg",
];

const equalizerDiv = document.getElementById("equalizer");
const canvas = document.getElementById("equalizerCanvas");
const ctx = canvas.getContext("2d");
const bgm = document.getElementById("bgm");
const playButton = document.getElementById("playButton");
const flag = document.getElementById("flag");
const cookie = document.getElementById("cookie");

function resizeCanvas() {
  const style = getComputedStyle(equalizerDiv);
  canvas.width = parseInt(style.width) * window.devicePixelRatio;
  canvas.height = parseInt(style.height) * window.devicePixelRatio;
  canvas.style.width = style.width;
  canvas.style.height = style.height;
  ctx.setTransform(1,0,0,1,0,0);
  ctx.scale(window.devicePixelRatio, window.devicePixelRatio);
}
resizeCanvas();
window.addEventListener("resize", resizeCanvas);

let audioCtx, source, analyser, dataArray;
function setupAudio() {
  audioCtx = new (window.AudioContext || window.webkitAudioContext)();
  source = audioCtx.createMediaElementSource(bgm);
  analyser = audioCtx.createAnalyser();
  analyser.fftSize = 128;
  source.connect(analyser);
  analyser.connect(audioCtx.destination);
  dataArray = new Uint8Array(analyser.frequencyBinCount);
}

// --- –ù–æ–≤—ã–π —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —ç–∫–≤–∞–ª–∞–π–∑–µ—Ä ---
function drawModernWave(){
  requestAnimationFrame(drawModernWave);
  if(!analyser) return;
  analyser.getByteFrequencyData(dataArray);
  const width = canvas.width / window.devicePixelRatio;
  const height = canvas.height / window.devicePixelRatio;
  ctx.clearRect(0,0,width,height);

  const points = dataArray.length;
  const waveLength = width / (points-1);
  const baseY = height*0.55;

  const gradientLine = ctx.createLinearGradient(0,0,width,0);
  gradientLine.addColorStop(0,"rgba(180,155,250,0.9)");
  gradientLine.addColorStop(0.5,"rgba(120,90,220,0.8)");
  gradientLine.addColorStop(1,"rgba(200,160,255,0.9)");

  const gradientFill = ctx.createLinearGradient(0,0,0,height);
  gradientFill.addColorStop(0,"rgba(180,155,250,0.25)");
  gradientFill.addColorStop(1,"rgba(120,90,220,0.05)");

  ctx.lineWidth = 6;
  ctx.lineJoin = "round";
  ctx.lineCap = "round";
  ctx.strokeStyle = gradientLine;
  ctx.fillStyle = gradientFill;
  ctx.beginPath();

  for(let i=0;i<points;i++){
    const x = i*waveLength;
    const amp = dataArray[i]/255;
    const y = baseY 
      - Math.sin(i*0.3 + performance.now()/500)*25*amp 
      - Math.sin(i*0.1 + performance.now()/300)*18*amp 
      - amp*30;

    if(i===0) ctx.moveTo(x,y);
    else ctx.lineTo(x,y);
  }

  ctx.lineTo(width,height);
  ctx.lineTo(0,height);
  ctx.closePath();
  ctx.fill();
  ctx.stroke();
}

// --- –§–æ—Ç–æ ---
function spawnPhoto(){
  const photo = document.createElement("img");
  photo.src = photos[Math.floor(Math.random()*photos.length)];
  photo.classList.add("photo");
  photo.style.left = 50 + Math.random()*(window.innerWidth-100)+"px";
  document.body.appendChild(photo);

  const startTime = Date.now();
  const duration = 3500 + Math.random()*1500;

  function animate(){
    const t = (Date.now() - startTime)/duration;
    if(t<1){
      const y = -150 + (window.innerHeight+200)*Math.sin(t*Math.PI/2);
      const scale = 0.8 + 0.5 * Math.sin(t*Math.PI);
      const rotate = t*360;
      const opacity = Math.sin(t*Math.PI);
      photo.style.transform = `translate(-50%, ${y}px) scale(${scale}) rotate(${rotate}deg)`;
      photo.style.opacity = opacity;
      requestAnimationFrame(animate);
    } else {
      photo.remove();
    }
  }
  animate();
}

// --- –°–Ω–µ–≥ ---
function createSnowflake(){
  const flake = document.createElement("div");
  flake.className = "snowflake";
  flake.style.left = Math.random()*100 + "vw";
  flake.style.fontSize = (8+Math.random()*12)+"px";
  flake.style.animationDuration = (5+Math.random()*5)+"s";
  flake.textContent = "‚ùÑ";
  document.body.appendChild(flake);
  setTimeout(()=>flake.remove(), 10000);
}
setInterval(createSnowflake, 300);

// --- –ö–Ω–æ–ø–∫–∞ –∑–∞–ø—É—Å–∫–∞ ---
playButton.addEventListener("click", ()=>{
  flag.classList.add("hide"); 
  cookie.style.opacity = 1;

  setTimeout(()=>{
    if(!audioCtx) setupAudio();
    bgm.play().then(()=>{
      drawModernWave();
      setInterval(spawnPhoto, 1300);
      playButton.style.display = "none";
    });
  }, 1000);
});
</script>

</body>
</html>
