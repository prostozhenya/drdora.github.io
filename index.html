<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>–° –î–Ω—ë–º –†–æ–∂–¥–µ–Ω–∏—è, –î–∞—à–∞ üíñ</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap');

    body {
      margin: 0;
      overflow: hidden;
      height: 100vh;
      font-family: 'Poppins', sans-serif;
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      /* –¢–µ–º–Ω—ã–π –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π —Ñ–æ–Ω –≤–º–µ—Å—Ç–æ –±–µ–ª–æ–≥–æ */
      background: linear-gradient(135deg, #2a1a2f, #4c2e57);
      color: #ff99cc;
      position: relative;
    }

    h1 {
      position: absolute;
      top: 10%;
      font-size: 3em;
      text-align: center;
      color: #ff99cc;
      text-shadow: 0 0 10px #ff66cc, 0 0 30px #ff66ff;
      opacity: 0;
      animation: fadeIn 3s forwards;
    }
    @keyframes fadeIn {
      to {
        opacity: 1;
      }
    }

    #playButton {
      padding: 15px 40px;
      font-size: 1.3em;
      border: none;
      border-radius: 25px;
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(12px) saturate(180%);
      -webkit-backdrop-filter: blur(12px) saturate(180%);
      color: #fff;
      cursor: pointer;
      box-shadow: 0 0 20px rgba(255, 102, 204, 0.6);
      transition: 0.3s;
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
    }
    #playButton:hover {
      transform: translateY(-50%) scale(1.1);
      box-shadow: 0 0 40px rgba(255, 102, 204, 0.9);
    }

    /* –ù–æ–≤—ã–π —Å—Ç–∏–ª—å —ç–∫–≤–∞–ª–∞–π–∑–µ—Ä–∞ - –≤–æ–ª–Ω–∞ —Å –±–ª–µ—Å–∫–æ–º */
    #equalizer {
      position: absolute;
      bottom: 50px;
      left: 50%;
      transform: translateX(-50%);
      width: 90%;
      height: 100px;
      overflow: visible;
      pointer-events: none;
    }
    #equalizer canvas {
      width: 100%;
      height: 100%;
      display: block;
    }

    /* –§–æ—Ç–æ –î–∞—à–∏ */
    .photo {
      position: absolute;
      width: 140px;
      height: 140px;
      border-radius: 20px;
      object-fit: cover;
      pointer-events: none;
      transform: translate(-50%, -50%);
      box-shadow: 0 0 20px rgba(255, 102, 204, 0.8),
        0 0 40px rgba(255, 102, 255, 0.5);
      transition: transform 0.3s ease, opacity 0.3s ease;
    }

    /* Footer */
    footer {
      position: absolute;
      bottom: 20px;
      text-align: center;
      font-size: 14px;
      color: #ff99cc;
    }
    footer a {
      color: #ff66cc;
      text-decoration: none;
      margin: 0 6px;
    }
  </style>
</head>
<body>
  <h1>–° –î–Ω—ë–º –†–æ–∂–¥–µ–Ω–∏—è, –î–∞—à–∞ üéÇüí´</h1>
  <button id="playButton">–ù–∞–∂–º–∏, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –º—É–∑—ã–∫—É üéµ</button>
  <audio id="bgm" loop>
    <source src="music/papa_temnogo_princa.mp3" type="audio/mpeg" />
  </audio>
  <div id="equalizer"><canvas></canvas></div>
  <footer>
    designed by <b>prostozhenyaaa</b><br />
    <a href="#">Instagram</a> | <a href="#">VK</a> | <a href="#">Telegram</a>
  </footer>

  <script>
    const photos = [
      "images/dasha1.jpg",
      "images/dasha2.jpg",
      "images/dasha3.jpg",
      "images/dasha4.jpg",
    ];
    const equalizer = document.getElementById("equalizer");
    const canvas = equalizer.querySelector("canvas");
    const ctx = canvas.getContext("2d");
    const bgm = document.getElementById("bgm");
    const playButton = document.getElementById("playButton");

    // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä canvas –ø–æ–¥ —ç–ª–µ–º–µ–Ω—Ç
    function resizeCanvas() {
      canvas.width = equalizer.clientWidth * window.devicePixelRatio;
      canvas.height = equalizer.clientHeight * window.devicePixelRatio;
      ctx.scale(window.devicePixelRatio, window.devicePixelRatio);
    }
    resizeCanvas();
    window.addEventListener("resize", () => {
      resizeCanvas();
    });

    // –ê–Ω–∏–º–∞—Ü–∏—è –≤–æ–ª–Ω—ã —ç–∫–≤–∞–ª–∞–π–∑–µ—Ä–∞
    let audioCtx, analyser, source, dataArray;

    function setupAudio() {
      audioCtx = new (window.AudioContext || window.webkitAudioContext)();
      source = audioCtx.createMediaElementSource(bgm);
      analyser = audioCtx.createAnalyser();
      analyser.fftSize = 128;
      source.connect(analyser);
      analyser.connect(audioCtx.destination);
      dataArray = new Uint8Array(analyser.frequencyBinCount);
    }

    function drawWave() {
      requestAnimationFrame(drawWave);
      analyser.getByteFrequencyData(dataArray);

      ctx.clearRect(0, 0, canvas.width, canvas.height);

      const width = canvas.width / window.devicePixelRatio;
      const height = canvas.height / window.devicePixelRatio;

      // –°–æ–∑–¥–∞–µ–º –ø–ª–∞–≤–Ω—É—é –≤–æ–ª–Ω—É –ø–æ —Å–∏–Ω—É—Å–æ–∏–¥–µ —Å —É—Å–∏–ª–µ–Ω–∏–µ–º –ø–æ —á–∞—Å—Ç–æ—Ç–µ
      ctx.lineJoin = "round";
      ctx.lineCap = "round";

      // –†–∏—Å—É–µ–º –±–ª–∏–∫–∏ –Ω–∞ –≤–æ–ª–Ω–µ
      const gradient = ctx.createLinearGradient(0, 0, width, 0);
      gradient.addColorStop(0, "#ff66cc");
      gradient.addColorStop(0.5, "#ff33aa");
      gradient.addColorStop(1, "#cc33ff");

      ctx.strokeStyle = gradient;
      ctx.lineWidth = 5;

      ctx.beginPath();
      const pointsCount = 50;
      for (let i = 0; i < pointsCount; i++) {
        const x = (i / (pointsCount - 1)) * width;
        // –£—Å–∏–ª–∏–≤–∞–µ–º –∞–º–ø–ª–∏—Ç—É–¥—É –ø–æ —á–∞—Å—Ç–æ—Ç–µ
        const freqIndex = Math.floor((i / pointsCount) * dataArray.length);
        const amp = dataArray[freqIndex] / 255;
        const y =
          height / 2 +
          Math.sin((i / pointsCount) * Math.PI * 4 + performance.now() / 500) *
            20 *
            amp;
        if (i === 0) ctx.moveTo(x, y);
        else ctx.lineTo(x, y);
      }
      ctx.stroke();

      // –î–æ–±–∞–≤–∏–º —Å–≤–µ—Ç—è—â–∏–π—Å—è "–±–ª–∏–∫"
      for (let i = 0; i < pointsCount; i += 10) {
        const x = (i / (pointsCount - 1)) * width;
        const freqIndex = Math.floor((i / pointsCount) * dataArray.length);
        const amp = dataArray[freqIndex] / 255;

        if (amp > 0.3) {
          ctx.beginPath();
          ctx.shadowColor = "rgba(255, 102, 204, 0.8)";
          ctx.shadowBlur = 15;
          ctx.arc(x, height / 2, 8 * amp, 0, 2 * Math.PI);
          ctx.fillStyle = "rgba(255, 102, 204, 0.6)";
          ctx.fill();
          ctx.shadowBlur = 0;
        }
      }
    }

    // –§—É–Ω–∫—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è –∏ –∏—Å—á–µ–∑–Ω–æ–≤–µ–Ω–∏—è —Ñ–æ—Ç–æ –î–∞—à–∏
    function easeOutQuad(t) {
      return t * (2 - t);
    }
    function easeInQuad(t) {
      return t * t;
    }
    function spawnPhoto() {
      const photo = document.createElement("img");
      photo.src = photos[Math.floor(Math.random() * photos.length)];
      photo.classList.add("photo");
      photo.style.left =
        50 + Math.random() * (window.innerWidth - 100) + "px";
      document.body.appendChild(photo);
      let start = Date.now();
      const duration = 3500 + Math.random() * 2000;
      const startY = -250;
      const endY = window.innerHeight / 2 - 70;
      const maxScale = 1.5 + Math.random() * 0.5;
      function animatePhoto() {
        const now = Date.now();
        const t = (now - start) / duration;
        if (t < 1) {
          const y = startY + (endY - startY) * easeOutQuad(t);
          const scale = 1 + (maxScale - 1) * easeOutQuad(t);
          const rotate = t * 720;
          const opacity = Math.sin(t * Math.PI);
          photo.style.transform = `translate(-50%, ${y}px) scale(${scale}) rotate(${rotate}deg)`;
          photo.style.opacity = opacity;
          requestAnimationFrame(animatePhoto);
        } else {
          start = Date.now();
          const currentScale = maxScale;
          const currentY = endY;
          function returnAnimate() {
            const t2 = (Date.now() - start) / duration;
            if (t2 < 1) {
              const y = currentY - (currentY - startY) * easeInQuad(t2);
              const scale = currentScale - (currentScale - 1) * easeInQuad(t2);
              const rotate = 720 + t2 * 720;
              const opacity = Math.cos((t2 * Math.PI) / 2);
              photo.style.transform = `translate(-50%, ${y}px) scale(${scale}) rotate(${rotate}deg)`;
              photo.style.opacity = opacity;
              requestAnimationFrame(returnAnimate);
            } else {
              photo.remove();
            }
          }
          returnAnimate();
        }
      }
      animatePhoto();
    }

    // –ó–∞–ø—É—Å–∫ –º—É–∑—ã–∫–∏, —ç–∫–≤–∞–ª–∞–π–∑–µ—Ä–∞ –∏ —Ñ–æ—Ç–æ
    playButton.addEventListener("click", () => {
      bgm.play().then(() => {
        setupAudio();
        drawWave();
        setInterval(spawnPhoto, 1500);
        playButton.style.display = "none";
      });
    });
  </script>
</body>
</html>
